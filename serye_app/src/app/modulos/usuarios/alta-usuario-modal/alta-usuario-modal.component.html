<nb-card >
    <nb-card-body >
        <nb-stepper fxFlex="100">
            <nb-step [stepControl]="infoGeneralForm" label="First step">
                <form #infoGeneralForm="ngForm" class="step-container">
                    <div class="container-fluid">
                        <div class="row">
                            <!--<div class="col-lg-6 col-md-6 col-sm-12">
                                <mat-form-field class="w-100">
                                    <mat-label>Tipo de usuario</mat-label>
                                    <mat-select [(ngModel)]="nuevoUsuario.tipo" #tipo="ngModel" name="tipo" required>
                                        <mat-option disabled [value]="">
                                            Selecciona un tipo de usuario
                                        </mat-option>
                                        <ng-container *ngIf="_serAutenticacion.obtenerTipoUsuario() == TiposUsuario.Root">
                                            <mat-option [value]="TiposUsuario.Administrador">
                                                {{_serFuncionesGenerales.obtenerTipoUsuario(TiposUsuario.Administrador)}}
                                            </mat-option>
                                            <mat-option [value]="TiposUsuario.Empleado">
                                                {{_serFuncionesGenerales.obtenerTipoUsuario(TiposUsuario.Empleado)}}
                                            </mat-option>
                                        </ng-container>
                                    </mat-select>
                                    <mat-error *ngIf="(tipo.invalid && (tipo.dirty || tipo.touched)) && tipo.errors.required">
                                        Por favor selecciona un tipo de usuario
                                    </mat-error>
                                </mat-form-field>
                            </div>-->
                            <div class="col-lg-6 col-md-6 col-sm-12">
                                <mat-form-field class="w-100">
                                    <input type="text" nbInput fullWidth shape="rectangle" [(ngModel)]="nuevoUsuario.usuario" #usuario="ngModel" name="usuario" matInput
                                           placeholder="Ingresa el nombre de usuario" pattern="{{ ExpresionesRegulares[1].expresion }}" required
                                          [existe]="nombreUsuarioExistente" (keyup)="existeNombreUsuario()">
                                    <mat-error *ngIf="(usuario.invalid && (usuario.dirty || usuario.touched)) && usuario.errors.required">
                                        Por favor ingresa el nombre de usuario
                                    </mat-error>
                                    <mat-error *ngIf="(usuario.invalid && (usuario.dirty || usuario.touched)) && usuario.errors.pattern">
                                        {{ ExpresionesRegulares[1].mensaje }}
                                    </mat-error>
                                    <mat-error *ngIf="(usuario.invalid && (usuario.dirty || usuario.touched)) && usuario.errors.existe">
                                        Nombre de usuario ocupado, favor de intentar con uno diferente
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="inputFirstName" class="label">First Name</label>
                                    <input type="text" nbInput fullWidth id="inputFirstName" placeholder="First Name">
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="inputLastName" class="label">Last Name</label>
                                    <input type="text" nbInput fullWidth id="inputLastName" placeholder="Last Name">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6 col-md-6 col-sm-12 form-group">
                                <label class="label" for="input-nombre">Nombre</label>
                                <input type="text" nbInput fullWidth shape="rectangle" [(ngModel)]="nuevoUsuario.nombre" #nombre="ngModel" name="nombre" matInput
                                       placeholder="Ingresa el nombre" pattern="{{ ExpresionesRegulares[3].expresion }}" id="input-nombre" required>
                                <ng-container *ngIf="(nombre.invalid && (nombre.dirty || nombre.touched)) && nombre.errors.required">
                                    <p class="caption status-danger" *ngIf="nombre.errors?.required">Porn favor ingresa el nombre</p>
                                </ng-container>
                                <ng-container *ngIf="(nombre.invalid && (nombre.dirty || nombre.touched)) && nombre.errors.pattern">
                                    <p class="caption status-danger" *ngIf="nombre.errors?.required">{{ ExpresionesRegulares[3].mensaje }}</p>
                                </ng-container>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-12 form-group">
                                    <mat-label>Apellido paterno</mat-label>
                                    <input type="text" nbInput fullWidth shape="rectangle" [(ngModel)]="nuevoUsuario.apepat" #apepat="ngModel" name="apepat" matInput
                                           placeholder="Ingresa el apellido paterno" pattern="{{ ExpresionesRegulares[4].expresion }}" required>
                                    <mat-error *ngIf="(apepat.invalid && (apepat.dirty || apepat.touched)) && apepat.errors.required">
                                        Por favor ingresa el apellido paterno
                                    </mat-error>
                                    <mat-error *ngIf="(apepat.invalid && (apepat.dirty || apepat.touched)) && apepat.errors.pattern">
                                        {{ ExpresionesRegulares[4].mensaje }}
                                    </mat-error>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12">
                                <mat-form-field class="w-100">
                                    <mat-label>Apellido materno</mat-label>
                                    <input type="text" nbInput fullWidth shape="rectangle" [(ngModel)]="nuevoUsuario.apemat" #apemat="ngModel" name="apemat" matInput
                                           placeholder="Ingresa el apellido materno" pattern="{{ ExpresionesRegulares[4].expresion }}">
                                    <mat-error *ngIf="(apemat.invalid && (apemat.dirty || apemat.touched)) && apemat.errors.pattern">
                                        {{ ExpresionesRegulares[4].mensaje }}
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row" *ngIf="nuevoUsuario.tipo == TiposUsuario.Administrador">
                            <!--<div class="col-lg-6 col-md-6 col-sm-12">
                                <mat-form-field class="w-100">
                                    <mat-label>Tipo de persona</mat-label>
                                    <mat-select [(ngModel)]="nuevoUsuario.tipoDePersona" #tipoDePersona="ngModel" name="tipoDePersona"
                                                required>
                                        <mat-option disabled [value]="">
                                            Selecciona el tipo de persona
                                        </mat-option>
                                        <mat-option [value]="TiposDePersona.Moral">
                                            {{_serFuncionesGenerales.obtenerTipoDePersona(TiposDePersona.Moral)}}
                                        </mat-option>
                                        <mat-option [value]="TiposDePersona.Fisica">
                                            {{_serFuncionesGenerales.obtenerTipoDePersona(TiposDePersona.Fisica)}}
                                        </mat-option>
                                    </mat-select>
                                    <mat-error
                                            *ngIf="(tipoDePersona.invalid && (tipoDePersona.dirty || tipoDePersona.touched)) && tipoDePersona.errors.required">
                                        Por favor selecciona un tipo de persona
                                    </mat-error>
                                </mat-form-field>
                            </div>-->
                            <div class="col-lg-6 col-md-6 col-sm-12">
                                <mat-form-field class="w-100">
                                    <mat-label>RFC</mat-label>
                                    <input type="text" nbInput fullWidth shape="rectangle" [(ngModel)]="nuevoUsuario.rfc" #rfc="ngModel" name="rfc" id="" matInput
                                           placeholder="Ingresa el RFC" [disabled]="!nuevoUsuario.tipoDePersona"
                                           pattern="{{ nuevoUsuario.tipoDePersona == TiposDePersona.Moral ? ExpresionesRegulares[6].expresion : ExpresionesRegulares[7].expresion }}"
                                           (blur)="convertirRfcMayusculas()">
                                    <mat-error *ngIf="(rfc.invalid && (rfc.dirty || rfc.touched)) && rfc.errors.required">
                                        Por favor ingresa el RFC
                                    </mat-error>
                                    <mat-error *ngIf="(rfc.invalid && (rfc.dirty || rfc.touched)) && rfc.errors.pattern">
                                        {{ nuevoUsuario.tipoDePersona == TiposDePersona.Moral ? ExpresionesRegulares[6].mensaje : ExpresionesRegulares[7].mensaje }}
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                        <!--<div class="row">
                            <button mat-raised-button matStepperNext color="primary" class="ml-auto"
                                    [disabled]="!infoGeneralForm.valid || contadorPeticionesNombreUsuarioExistente > 0"
                                    (click)="obtenerEstados()">Siguiente <mat-icon>navigate_next</mat-icon></button>
                        </div>-->
                    </div>
                    <button nbButton nbStepperNext>next</button>
                </form>
            </nb-step>
        </nb-stepper>
    </nb-card-body>
</nb-card>
