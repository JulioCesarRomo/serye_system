<div class="row mt-3 mr-0 ml-0">
    <div class="col-6 pl-0">
        <button mat-button mat-raised-button  class="btn-exito w-100" (click)="abrirAltaEmpleadoModalComponent()">
            <mat-icon>person_add</mat-icon> Agregar empleado
        </button>
    </div>
    <div class="col-6 pr-0">
        <button mat-button mat-raised-button class="btn-exito w-100" >
            <mat-icon>cloud_upload</mat-icon> Importar empleados (Excel)
        </button>
    </div>
</div>
<div class="row m-2">
    <div class="col-12 d-flex align-items-center">
        <mat-form-field appearance="legacy" class="w-100">
            <mat-label>Buscar</mat-label>
            <input [(ngModel)]="filtro" (keyup)="buscarEmpleados()" matInput placeholder="Ingresa tu búsqueda">
            <mat-icon matSuffix>search</mat-icon>
        </mat-form-field>
    </div>
</div>
<div class="tabla-panel-administracion">
    <table [@carga]="'in'" mat-table [dataSource]="dataSource" class="w-100" multiTemplateDataRows>
        <ng-container matColumnDef="sucursal">
            <th mat-header-cell *matHeaderCellDef> Sucursal </th>
            <td mat-cell *matCellDef="let empleado"> {{ empleado.sucursal }} </td>
        </ng-container>
        <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef> Nombre </th>
            <td mat-cell *matCellDef="let empleado"> {{ _serFuncionesGenerales.obtenerNombreCompletoEmpleado(empleado)}} </td>
        </ng-container>
        <ng-container matColumnDef="rfc">
            <th mat-header-cell *matHeaderCellDef> RFC </th>
            <td mat-cell *matCellDef="let empleado"> {{empleado.rfc}} </td>
        </ng-container>
        <ng-container matColumnDef="correo">
            <th mat-header-cell *matHeaderCellDef> Correo </th>
            <td mat-cell *matCellDef="let empleado"> {{empleado.correo ? empleado.correo : '-'}} </td>
        </ng-container>
        <ng-container matColumnDef="opciones" class="text-center">
            <th mat-header-cell *matHeaderCellDef class="text-center"> Opciones </th>
            <td mat-cell *matCellDef="let empleado" class="text-center">
                <button class="icono-info" mat-icon-button matTooltip="Ver empleado" (click)="abrirVistaEmpleadoModal(empleado)">
                    <mat-icon>remove_red_eye</mat-icon>
                </button>
                <button class="icono-exito" mat-icon-button (click)="abrirConceptosEmpleado(empleado)"
                        matTooltip="Administrar percepciones/deducciones">
                    <mat-icon>attach_money</mat-icon>
                </button>
                <button class="icono-error" mat-icon-button (click)="actualizarEstadoEmpleado(empleado)"
                        matTooltip="Eliminar empleado">
                    <mat-icon>delete</mat-icon>
                </button>
                <button class="icono-info" mat-icon-button matTooltip="Más opciones"
                        (click)="empleadoExpandido = empleadoExpandido === empleado ? null : empleado">
                    <mat-icon>settings</mat-icon>
                </button>
            </td>
        </ng-container>
        <ng-container matColumnDef="detalleDeExpansion">
            <td mat-cell *matCellDef="let empleado" [attr.colspan]="columnasMostradas.length">
                <div class="detalle-empleado" [@detalleDeExpansion]="empleado == empleadoExpandido ? 'expanded' : 'collapsed'">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-4 col-md-4 col-sm-6 mb-1">
                                <button class="btn-advertencia w-100" mat-flat-button
                                        (click)="abrirActualizacionInformacionGeneralEmpleadoModal(empleado)">
                                    <mat-icon>create</mat-icon> Información general
                                </button>
                            </div>
                            <div class="col-lg-4 col-md-4 col-sm-6 mb-1">
                                <button class="btn-advertencia w-100" mat-flat-button
                                        (click)="abrirActualizacionDireccionEmpleadoModal(empleado)">
                                    <mat-icon>create</mat-icon> Direccion
                                </button>
                            </div>
                            <div class="col-lg-4 col-md-4 col-sm-6 mb-1">
                                <button class="btn-advertencia w-100" mat-flat-button
                                        (click)="abrirActualizacionDatosContratacionEmpleadoModal(empleado)">
                                    <mat-icon>create</mat-icon> Datos Contratacion
                                </button>
                            </div>
                            <div class="col-lg-4 col-md-4 col-sm-6 mb-1">
                                <button class="btn-advertencia w-100" mat-flat-button
                                        (click)="abrirActualizacionDatosSalarioEmpleadoModal(empleado)">
                                    <mat-icon>create</mat-icon> Datos Salario
                                </button>
                            </div>
                            <div class="col-lg-4 col-md-4 col-sm-6 mb-1">
                                <button class="btn-advertencia w-100" mat-flat-button
                                        (click)="abrirActualizacionFotografiaEmpleadoModal(empleado)">
                                    <mat-icon>create</mat-icon> Fotografía
                                </button>
                            </div>
                            <div class="col-lg-4 col-md-4 col-sm-6 mb-1">
                                <button class="btn-exito w-100" mat-flat-button
                                        (click)="abrirConceptosEmpleado(empleado)">
                                    <mat-icon>add</mat-icon> Percepciones/Deducciones/Otros pagos
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="columnasMostradas"></tr>
        <tr mat-row *matRowDef="let cliente; columns: columnasMostradas;" class="fila-empleado"></tr>
        <tr mat-row *matRowDef="let cliente; columns: ['detalleDeExpansion']" class="fila-detalle-empleado"></tr>
    </table>
</div>
<app-alerta *ngIf="dataSource != null && dataSource.data.length == 0 && (filtro == null || filtro == '')"
            mensaje="No se tienen resultados registrados por el momento." color="advertencia"></app-alerta>
<app-alerta *ngIf="dataSource != null && dataSource.data.length == 0 && (filtro != null && filtro != '')"
            mensaje="La búsqueda no arrojó resultados." color="info"></app-alerta>
<app-paginador #paginador [filtro]="filtro" (cambioDePaginaEvento)="cambioDePaginaEventoPaginador($event)"
               [total]="totalClientes">
</app-paginador>
